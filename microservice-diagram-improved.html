<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sơ đồ Kiến trúc Microservice - Bộ sung 3 Service Mới</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
            color: #333;
        }

        .diagram {
            position: relative;
            width: 100%;
            height: 900px;
            background-color: #fffef0;
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
        }

        /* SVG for connection lines */
        .connection-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* Frontend Layer */
        .frontend-layer {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background-color: #fff8dc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ccc;
            z-index: 10;
        }

        .frontend-box {
            background-color: #e6e6fa;
            border: 1px solid #9370db;
            border-radius: 5px;
            padding: 8px 12px;
            text-align: center;
            font-size: 11px;
            min-width: 80px;
        }

        /* API Gateway */
        .api-gateway {
            position: absolute;
            top: 140px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #e6e6fa;
            border: 1px solid #9370db;
            border-radius: 5px;
            padding: 10px 15px;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            z-index: 10;
        }

        /* Backend Services Layer */
        .backend-layer {
            position: absolute;
            top: 220px;
            left: 20px;
            right: 20px;
            height: 350px;
            background-color: #f0fff0;
            border: 1px solid #90ee90;
            border-radius: 8px;
            padding: 20px;
            z-index: 5;
        }

        .service-box {
            position: absolute;
            border-radius: 5px;
            padding: 8px 12px;
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            min-width: 80px;
            border: 1px solid;
            z-index: 10;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* Green services */
        .service-green {
            background-color: #90ee90;
            border-color: #32cd32;
            color: #006400;
        }

        /* Pink services */
        .service-pink {
            background-color: #ffb6c1;
            border-color: #ff69b4;
            color: #8b0000;
        }

        /* Service positions - adjusted for better layout */
        .admin-service { top: 40px; left: 350px; }
        .agent-policy-service { top: 100px; left: 150px; }
        .agent-management-service { top: 100px; left: 350px; }
        .news-service { top: 100px; left: 550px; }
        .cart-service { top: 100px; left: 750px; }
        .contract-service { top: 160px; left: 50px; }
        .user-service { top: 160px; left: 250px; }
        .payment-service { top: 160px; left: 450px; }
        .product-service { top: 160px; left: 650px; }
        .chatbot-service { top: 220px; left: 150px; }
        .design-calculation-service { top: 220px; left: 350px; }
        .inventory-management-service { top: 220px; left: 550px; }

        /* Database Layer */
        .database-layer {
            position: absolute;
            bottom: 120px;
            left: 20px;
            right: 20px;
            height: 120px;
            background-color: #f0f8ff;
            border: 1px solid #87ceeb;
            border-radius: 8px;
            padding: 20px;
            z-index: 5;
        }

        .db-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 15px;
            color: #4682b4;
        }

        .database-row {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 8px;
        }

        .database-box {
            background-color: #e6f3ff;
            border: 1px solid #87ceeb;
            border-radius: 5px;
            padding: 6px 10px;
            text-align: center;
            font-size: 10px;
            min-width: 70px;
            z-index: 10;
        }

        /* Infrastructure boxes */
        .infrastructure-box {
            position: absolute;
            bottom: 20px;
            background-color: #ffe4e1;
            border: 1px solid #ffa07a;
            border-radius: 5px;
            padding: 6px 10px;
            text-align: center;
            font-size: 10px;
            z-index: 10;
        }

        .message-broker { right: 150px; }
        .cache { right: 50px; }

        /* Labels */
        .label {
            position: absolute;
            font-size: 11px;
            color: #666;
            font-style: italic;
            z-index: 10;
        }

        .api-label {
            top: 120px;
            right: 100px;
        }

        .backend-label {
            top: 200px;
            left: 30px;
        }

        .infrastructure-label {
            bottom: 250px;
            right: 30px;
        }

        /* Hover effects */
        .service-box:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Sơ đồ Kiến trúc Microservice - Bộ sung 3 Service Mới</div>
        
        <div class="diagram">
            <!-- SVG for connection lines -->
            <svg class="connection-svg" viewBox="0 0 1360 900">
                <!-- Frontend to API Gateway connections -->
                <g stroke="#666" stroke-width="2" fill="none">
                    <!-- From Client Frontend -->
                    <path d="M 340 95 Q 340 120 340 140" />
                    <!-- From Admin Frontend -->
                    <path d="M 450 95 Q 450 120 450 140" />
                    <!-- From Agent Portal -->
                    <path d="M 560 95 Q 560 120 560 140" />
                    <!-- From Agent Admin Frontend -->
                    <path d="M 670 95 Q 670 120 670 140" />
                    
                    <!-- Converging to API Gateway -->
                    <path d="M 340 140 Q 500 140 680 165" />
                    <path d="M 450 140 Q 500 140 680 165" />
                    <path d="M 560 140 Q 500 140 680 165" />
                    <path d="M 670 140 Q 500 140 680 165" />
                </g>

                <!-- API Gateway to Services main distribution -->
                <g stroke="#666" stroke-width="2" fill="none">
                    <!-- Main vertical line from API Gateway -->
                    <line x1="680" y1="185" x2="680" y2="220" />
                    
                    <!-- Main horizontal distribution line -->
                    <line x1="100" y1="220" x2="1200" y2="220" />
                    
                    <!-- Vertical lines to each service -->
                    <line x1="390" y1="220" x2="390" y2="260" /> <!-- Admin Service -->
                    <line x1="190" y1="220" x2="190" y2="320" /> <!-- Agent Policy -->
                    <line x1="390" y1="220" x2="390" y2="320" /> <!-- Agent Management -->
                    <line x1="590" y1="220" x2="590" y2="320" /> <!-- News -->
                    <line x1="790" y1="220" x2="790" y2="320" /> <!-- Cart -->
                    <line x1="90" y1="220" x2="90" y2="380" />  <!-- Contract -->
                    <line x1="290" y1="220" x2="290" y2="380" /> <!-- User -->
                    <line x1="490" y1="220" x2="490" y2="380" /> <!-- Payment -->
                    <line x1="690" y1="220" x2="690" y2="380" /> <!-- Product -->
                    <line x1="190" y1="220" x2="190" y2="440" /> <!-- Chatbot -->
                    <line x1="390" y1="220" x2="390" y2="440" /> <!-- Design Calc -->
                    <line x1="590" y1="220" x2="590" y2="440" /> <!-- Inventory -->
                </g>

                <!-- Services to Database connections -->
                <g stroke="#999" stroke-width="1.5" fill="none">
                    <!-- From each service to corresponding database -->
                    <line x1="90" y1="420" x2="90" y2="650" />   <!-- Contract to Contract DB -->
                    <line x1="190" y1="460" x2="190" y2="650" /> <!-- Chatbot to Chatbot DB -->
                    <line x1="290" y1="400" x2="290" y2="650" /> <!-- User to User DB -->
                    <line x1="390" y1="480" x2="390" y2="650" /> <!-- Design to Design DB -->
                    <line x1="490" y1="400" x2="490" y2="650" /> <!-- Payment to Payment DB -->
                    <line x1="590" y1="460" x2="590" y2="650" /> <!-- Inventory to Inventory DB -->
                    <line x1="690" y1="400" x2="690" y2="650" /> <!-- Product to Product DB -->
                    <line x1="790" y1="340" x2="790" y2="650" /> <!-- Cart to Cart DB -->
                    <line x1="890" y1="650" x2="890" y2="650" /> <!-- News to News DB -->
                    <line x1="990" y1="650" x2="990" y2="650" /> <!-- Agent Management DB -->
                    <line x1="1090" y1="650" x2="1090" y2="650" /> <!-- Agent Policy DB -->
                    <line x1="1190" y1="650" x2="1190" y2="650" /> <!-- Admin DB -->
                </g>

                <!-- Infrastructure connections -->
                <g stroke="#999" stroke-width="1.5" fill="none">
                    <!-- Message Broker connections -->
                    <line x1="1050" y1="650" x2="1050" y2="850" />
                    <!-- Cache connections -->
                    <line x1="1150" y1="650" x2="1150" y2="850" />
                </g>
            </svg>

            <!-- Frontend Applications -->
            <div class="frontend-layer">
                <div class="frontend-box">
                    <strong>Client Frontend</strong><br>
                    Giao diện người dùng cuối
                </div>
                <div class="frontend-box">
                    <strong>Admin Frontend</strong><br>
                    Giao diện quản trị hệ thống
                </div>
                <div class="frontend-box">
                    <strong>Agent Portal</strong><br>
                    Cổng Đại lý
                </div>
                <div class="frontend-box">
                    <strong>Agent Admin Frontend</strong><br>
                    Giao diện quản trị Đại lý
                </div>
            </div>

            <!-- API Gateway -->
            <div class="api-gateway">
                API Gateway<br>
                <small>(Cổng API)</small>
            </div>

            <!-- Labels -->
            <div class="label api-label">API Gateway (Cổng API)</div>
            <div class="label backend-label">Backend Microservices<br>(Các dịch vụ Bộ lõi)</div>
            <div class="label infrastructure-label">Infrastructure (Hạ tầng)<br>Databases</div>

            <!-- Backend Services Layer -->
            <div class="backend-layer">
                <!-- Admin Service -->
                <div class="service-box service-green admin-service">
                    <strong>Admin Service</strong><br>
                    Dịch vụ Quản trị Tổng hợp
                </div>

                <!-- Row 2 Services -->
                <div class="service-box service-green agent-policy-service">
                    <strong>Agent Policy Service</strong><br>
                    Dịch vụ Chính sách Đại lý
                </div>
                <div class="service-box service-green agent-management-service">
                    <strong>Agent Management Service</strong><br>
                    Dịch vụ Quản lý Đại lý
                </div>
                <div class="service-box service-pink news-service">
                    <strong>News Service</strong><br>
                    Dịch vụ Tin tức
                </div>
                <div class="service-box service-pink cart-service">
                    <strong>Cart Service</strong><br>
                    Dịch vụ Giỏ hàng
                </div>

                <!-- Row 3 Services -->
                <div class="service-box service-green contract-service">
                    <strong>Contract Service</strong><br>
                    Dịch vụ Hợp đồng
                </div>
                <div class="service-box service-green user-service">
                    <strong>User Service</strong><br>
                    Dịch vụ Người dùng
                </div>
                <div class="service-box service-green payment-service">
                    <strong>Payment Service</strong><br>
                    Dịch vụ Thanh toán
                </div>
                <div class="service-box service-pink product-service">
                    <strong>Product Service</strong><br>
                    Dịch vụ Sản phẩm
                </div>

                <!-- Row 4 Services -->
                <div class="service-box service-green chatbot-service">
                    <strong>Chatbot Service</strong><br>
                    Dịch vụ Chatbot
                </div>
                <div class="service-box service-green design-calculation-service">
                    <strong>Design Calculation Service</strong><br>
                    Dịch vụ Tính toán Thiết kế
                </div>
                <div class="service-box service-green inventory-management-service">
                    <strong>Inventory Management Service</strong><br>
                    Dịch vụ Quản lý Kho
                </div>
            </div>

            <!-- Database Layer -->
            <div class="database-layer">
                <div class="db-title">Infrastructure (Hạ tầng)<br>Databases</div>
                <div class="database-row">
                    <div class="database-box">User DB</div>
                    <div class="database-box">Admin DB</div>
                    <div class="database-box">Contract DB</div>
                    <div class="database-box">Agent Policy DB</div>
                    <div class="database-box">Payment DB</div>
                    <div class="database-box">Chatbot DB</div>
                    <div class="database-box">Design Calculation DB</div>
                    <div class="database-box">Inventory Management DB</div>
                    <div class="database-box">Agent Management DB</div>
                    <div class="database-box">Product DB</div>
                    <div class="database-box">Cart DB</div>
                    <div class="database-box">News DB</div>
                </div>
            </div>

            <!-- Infrastructure Components -->
            <div class="infrastructure-box message-broker">Message Broker</div>
            <div class="infrastructure-box cache">Cache</div>
        </div>
    </div>

    <script>
        // Add interactive features
        document.addEventListener('DOMContentLoaded', function() {
            const serviceBoxes = document.querySelectorAll('.service-box');
            
            serviceBoxes.forEach(box => {
                box.addEventListener('click', function() {
                    const serviceName = this.querySelector('strong').textContent;
                    alert(`Chi tiết về ${serviceName}\n\nĐây là một microservice trong hệ thống.`);
                });
            });

            // Add animation for connection lines
            const svg = document.querySelector('.connection-svg');
            const paths = svg.querySelectorAll('path, line');
            
            paths.forEach((path, index) => {
                path.style.strokeDasharray = '5,5';
                path.style.strokeDashoffset = '0';
                path.style.animation = `dash 2s linear infinite`;
                path.style.animationDelay = `${index * 0.1}s`;
            });
        });

        // Add CSS animation for dashed lines
        const style = document.createElement('style');
        style.textContent = `
            @keyframes dash {
                to {
                    stroke-dashoffset: -10;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>